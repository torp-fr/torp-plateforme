#!/bin/bash
# Quick reference for LLM audit findings

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "  LLM TRACKING AUDIT - QUICK REFERENCE"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

echo "ğŸ“Š TRACKING COVERAGE"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "âœ… TRACKED:     2 files (22%)"
echo "  â€¢ rag-orchestrator.ts (action: 'extract')"
echo "  â€¢ siret-extractor.ts (partial - no options)"
echo ""
echo "âŒ UNTRACKED:   7 files (78%)"
echo "  â€¢ generate-embedding/index.ts       - OpenAI embeddings"
echo "  â€¢ llm-completion/index.ts (x2)      - OpenAI + Anthropic"
echo "  â€¢ analyze-photo/index.ts            - GPT-4 Vision"
echo "  â€¢ ingest-document/index.ts          - Document OCR"
echo "  â€¢ scripts/rag-reingest.ts           - SDK embeddings"
echo "  â€¢ src/services/ai/claude.service.ts - Client-side Anthropic"
echo ""

echo "ğŸ’° COST IMPACT"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "Untracked daily:     ~80 API calls"
echo "Untracked monthly:   ~2,400 requests"
echo "Untracked tokens:    ~30-40M tokens/month"
echo "Untracked costs:     ~$300-450/month âŒ"
echo ""

echo "ğŸ”§ REQUIRED CHANGES"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "1. ADD TO ai-client.ts:"
echo "   â”œâ”€ generateEmbedding()   (for OpenAI embeddings)"
echo "   â”œâ”€ analyzeImage()        (for GPT-4 Vision)"
echo "   â””â”€ callOpenAI()          (for general completions)"
echo ""
echo "2. REFACTOR EDGE FUNCTIONS:"
echo "   â”œâ”€ generate-embedding/index.ts      (1h)"
echo "   â”œâ”€ llm-completion/index.ts          (2h)"
echo "   â”œâ”€ analyze-photo/index.ts           (1h)"
echo "   â”œâ”€ ingest-document/index.ts         (1.5h)"
echo "   â””â”€ scripts/rag-reingest.ts          (1h)"
echo ""
echo "3. TOTAL EFFORT: ~9 hours"
echo ""

echo "ğŸ“‹ UNTRACKED FUNCTIONS DETAIL"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo ""
echo "FILE: generate-embedding/index.ts"
echo "LINE: 36"
echo "CALL: fetch('https://api.openai.com/v1/embeddings')"
echo "TRACKING: âŒ NONE"
echo ""

echo "FILE: llm-completion/index.ts"
echo "LINE: 132 (Anthropic)"
echo "CALL: fetch('https://api.anthropic.com/v1/messages')"
echo "TRACKING: âŒ NONE"
echo ""
echo "LINE: 160 (OpenAI)"
echo "CALL: fetch('https://api.openai.com/v1/chat/completions')"
echo "TRACKING: âŒ NONE"
echo ""

echo "FILE: analyze-photo/index.ts"
echo "LINE: 309"
echo "CALL: fetch('https://api.openai.com/v1/chat/completions') [Vision]"
echo "TRACKING: âŒ NONE"
echo "COST: HIGH (expensive Vision API)"
echo ""

echo "FILE: ingest-document/index.ts"
echo "LINE: 75"
echo "CALL: fetch('https://api.openai.com/v1/chat/completions') [OCR]"
echo "TRACKING: âŒ NONE"
echo ""

echo "FILE: scripts/rag-reingest.ts"
echo "LINE: 21 (import), 41 (init)"
echo "SDK: import OpenAI from 'openai'"
echo "TRACKING: âŒ NONE"
echo ""

echo "FILE: src/services/ai/claude.service.ts"
echo "LINE: 13 (import), 42 (init)"
echo "SDK: import Anthropic from '@anthropic-ai/sdk'"
echo "TRACKING: âŒ NONE (client-side, can't track easily)"
echo ""

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "  DETAILED REPORTS:"
echo "  â€¢ LLM_AUDIT_REPORT.md      (comprehensive audit)"
echo "  â€¢ LLM_USAGE_TRACKING.md    (tracking implementation)"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
